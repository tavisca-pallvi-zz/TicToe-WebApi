using Microsoft.AspNetCore.Mvc.Filters;
using Microsoft.Extensions.Logging;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using TicToeWebsite.DataBaseAcces;
using TicToeWebsite.Models;


namespace TicToeWebsite
{
    public class LoggerAttribute : ResultFilterAttribute, IActionFilter
    {

        public void OnActionExecuted(ActionExecutedContext context)
        {
            if (context.Exception== null)
            {
                Logger.Response = "Success";
            }
            else
            {
                Logger.Response = "Failure";
                Logger.Exception = context.Exception.Message + context.Exception.Source;

            }
            Logger.LogId = Guid.NewGuid();
            // CassendraLogger.Add();
            LogDatabase.Add();
        }
        public void OnActionExecuting(ActionExecutingContext context)
        {
            string req = "";
            req = context.RouteData.Values["action"].ToString() + context.RouteData.Values["controller"].ToString();
            Logger.Request = req;
            Logger.Response = "NULL";
            Logger.Exception = "NULL";

        }
    }
}

















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































